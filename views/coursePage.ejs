<DOCTYPE HTML>
    <html>
    <head>
        <title>CoursePage</title>
        <meta name="viewport" content="width=device-width">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
        <link rel="stylesheet" href="styles/styles.css">
    </head>
    <body>
        <div class="container dashboardContainer" style="padding-bottom:0px;">
            <div class="row dashboardTop" style="padding-bottom:80px;">
                <div class="col-md-12">
                    <div class="row" style="margin-top:60px;text-shadow: 2px 1px 1px rgba(28,110,164,0.43);">
                        <div class="col-md-3"></div>
                        <div class="col-md-6">
                            <h2 class="text-center" style="color:#1C6EA4;">
                                Course : <%=coursename%>
                            </h2>
                        </div>
                        <div class="col-md-3"></div>
                    </div>
                </div> 
            </div>
            <div class="row" style="padding-bottom:20px;margin-top:10px;">
                <div class="col-md-12">
                    <div class="row " style="margin:0px">
                        <div class="col-md-3 courseContainer" style="height:100%;display:block">
                            <% if(status == 'Teacher'){%>
                                <div class="">
                                    <div class="dashboardButton"> 
                                        <form action="/add-assignment" method="get">
                                            <button type="submit" class="dashboardButton">Add Assignment</button>
                                            <input name="coursename" value='<%=coursename%>'readonly hidden/>
                                        </form>
                                    </div>
                                </div>
                            <%}%>
                            <div class="dashboardButton">
                                <form action="/dashboard" method="get"><button type="submit">Back</button>
                                </form>
                            </div>
                        </div>
                        <div class="col-md-9 courseContainer">
                            <div class="row" style=""> 
                                <div class="col-md-12">
                                    <h1 class="text-center" >
                                        Assignments
                                    </h1>
                                    <hr>
                                </div>
                            </div>
                            <div class="row" style="align-content:center;">
                                <% assignments.forEach(function(assignment, i){%>
                                <div class="col-md-12 courseContainer">
                                    <form action="/view-assignment" method="post">
                                        <input type="submit" class="dashboardButton" name="assignment" value='<%=assignment.title%>'readonly>
                                        <input name="id" value='<%=assignment.id%>'readonly hidden>
                                        <p style="color:Black">DEADLINE: '<%=assignment.dueDate%>'</p>
                                        <hr>
                                        <p style="color:Black">'TOTAL MARKS: <%=assignment.totalMarks%></p>
                                    </form>
                                    <%var count = assignment.attemptedBy.filter(function(s) { return s.student!=id && s.marked==false; }).length;%>
                                    <%=count%>
                                    <% if(assignment.grading=='peer' && assignment.attemptedBy.some(e=>e.student==id) && assignment.attemptedBy.some(e=>e.marked==false) && count>0){%>
                                            <form action="/peer-grading" method="get">
                                                <button type=submit style="color:Black"> Assignment available for peer-grading! </button>
                                                <input  name="id" value='<%=assignment.id%>'readonly hidden>
                                            </form>
                                    <%}%>
                                     
                                </div>
                                <%})%>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>